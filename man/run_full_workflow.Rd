% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/modelling.R
\name{run_full_workflow}
\alias{run_full_workflow}
\title{Run Country-Specific Spatial Modeling Workflow with Logging}
\usage{
run_full_workflow(
  country_code,
  survey_data_path = here::here("01_data", "1a_survey_data", "processed"),
  survey_data_suffix = "dhs_pr_records_combined.rds",
  shape_path = here::here("01_data", "1c_shapefiles"),
  shape_suffix = "district_shape.gpkg",
  pop_raster_path = here::here("01_data", "1b_rasters", "pop_raster"),
  pop_raster_suffix = "_ppp_2020_constrained.tif",
  ur_raster_path = here::here("01_data", "1b_rasters", "urban_extent"),
  ur_raster_suffix = "afurextent.asc",
  output_paths = list(model = here::here("03_outputs", "3a_model_outputs"), plot =
    here::here("03_outputs", "3b_visualizations"), raster = here::here("03_outputs",
    "3c_raster_outputs"), table = here::here("03_outputs", "3c_table_outputs"), compiled
    = here::here("03_outputs", "3d_compiled_results"), excel = here::here("03_outputs",
    "3d_compiled_results", "age_pop_denom_compiled.xlsx"), log = here::here("03_outputs",
    "3a_model_outputs", "modelling_log.rds")),
  model_params = list(cell_size = 5000, n_sim = 5000, ignore_cache = FALSE, age_range =
    c(0, 99), age_interval = 1, return_prop = TRUE, scale_outcome = "log_scale",
    shape_outcome = "log_shape", covariates = "urban", cpp_script =
    here::here("02_scripts", "model")),
  return_results = FALSE,
  n_cores = parallel::detectCores() - 2,
  ...
)
}
\arguments{
\item{country_code}{Character. The ISO3 country code (e.g., "TZA").}

\item{survey_data_path}{Character. Path to Survey data.
Default: "01_data/1a_survey_data/processed".}

\item{survey_data_suffix}{Character. Suffix for Survey data files.
Default: "dhs_pr_records_combined.rds".}

\item{shape_path}{Character. Path to shapefile data.
Default: "01_data/1c_shapefiles".}

\item{shape_suffix}{Character. Suffix for shapefile data.
Default: "district_shape.gpkg".}

\item{pop_raster_path}{Character. Path to population raster data.
Default: "01_data/1b_rasters/pop_raster".}

\item{pop_raster_suffix}{Character. Suffix for population raster files.
Default: "_ppp_2020_constrained.tif".}

\item{ur_raster_path}{Character. Path to urban-rural extent data.
Default: "01_data/1b_rasters/urban_extent".}

\item{ur_raster_suffix}{Character. Suffix for urban-rural raster.
Default: "afurextent.asc".}

\item{output_paths}{List of output paths:
\itemize{
  \item model: Path for model outputs.
       Default: "03_outputs/3a_model_outputs"
  \item plot: Path for plots.
       Default: "03_outputs/3b_visualizations"
  \item raster: Path for rasters.
       Default: "03_outputs/3c_raster_outputs"
  \item table: Path for tables.
       Default: "03_outputs/3c_table_outputs"
  \item compiled: Path for compiled results.
       Default: "03_outputs/3d_compiled_results"
  \item excel: Path for Excel outputs.
       Default:
        "03_outputs/3d_compiled_results/age_pop_denom_compiled.xlsx"
  \item log: Path for logs.
       Default: "03_outputs/3a_model_outputs/modelling_log.rds"
}}

\item{model_params}{List of model parameters:
\itemize{
  \item cell_size: Cell size in meters. Default: 5000
  \item n_sim: Number of simulations. Default: 5000
  \item ignore_cache: Whether to ignore cache. Default: FALSE
  \item age_range: Age range vector. Default: c(0, 99)
  \item age_interval: Age interval. Default: 1
  \item return_prop: Return proportions. Default: TRUE
  \item scale_outcome: Scale outcome variable. Default: "log_scale"
  \item shape_outcome: Shape outcome variable. Default: "log_shape"
  \item covariates: Model covariates. Default: "urban"
  \item cpp_script: C++ script path. Default: "02_scripts/model"
}}

\item{return_results}{Logical. Whether to return results. Default: FALSE.}

\item{n_cores}{Integer number of cores for parallel processing for age
population table, default detectCores()-2}

\item{...}{Additional arguments passed to subfunctions.}
}
\value{
If return_results is TRUE, a list containing:
  \itemize{
    \item spat_model_param: Fitted spatial model parameters
    \item predictor_data: Predictor dataset
    \item gamma_prediction: Generated gamma predictions
    \item pred_list: Processed gamma prediction results
    \item final_age_pop_table: Age-population table data
    \item final_pop: Compiled population data
    \item all_mod_params: Compiled model parameters
  }
}
\description{
This function runs the entire spatial modeling workflow for a given country
code and logs the results. It processes Survey data, fits a spatial model,
generates predictions, creates population tables, and produces raster
outputs. The function is modular and can be reused for different countries
with minimal adjustments.
}
\examples{
\dontrun{
# Run model for Tanzania with default parameters
results <- run_full_workflow(country_code = "TZA")

# Run with custom parameters
results <- run_full_workflow(
  country_code = "KEN",
  model_params = list(
    cell_size = 2500,
    n_sim = 10000,
    covariates = c("urban", "elevation")
  )
)
}

}
